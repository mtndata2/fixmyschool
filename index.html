

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FixMySchool â€“ Home</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <header>
    <h1>FixMySchool</h1>
    <nav>
      <a href="/report.html">Report an Issue</a>
      <a href="/about.html">About</a>
      <a href="/contact.html">Contact</a>
      <a href="/privacy.html">Privacy Policy</a>
    </nav>
  </header>

  <main>
    <h2>Approved Reports Gallery</h2>
    <div id="gallery"></div>
  </main>

  <script>
    async function loadReports() {
      const res = await fetch("https://fixmyschool-api.mtndatasales.workers.dev/reports");
      const { reports } = await res.json();
      const grouped = {};

      reports.forEach(report => {
        const date = new Date(report.timestamp).toLocaleDateString();
        if (!grouped[date]) grouped[date] = [];
        grouped[date].push(report);
      });

      const gallery = document.getElementById("gallery");
      gallery.innerHTML = "";

      for (const date in grouped) {
        const section = document.createElement("section");
        section.innerHTML = `<h3>${date}</h3>`;
        const scroll = document.createElement("div");
        scroll.className = "scroll-row";

        grouped[date].forEach(r => {
          const card = document.createElement("div");
          card.className = "report-card";
          card.innerHTML = `
            <a href="/view.html?id=${encodeURIComponent(r.id)}">
              <img src="${r.photoUrls[0]}" width="180" />
              <p><strong>${r.school}</strong><br/>${r.location}</p>
            </a>
          `;
          scroll.appendChild(card);
        });

        section.appendChild(scroll);
        gallery.appendChild(section);
      }
    }

    window.onload = loadReports;
  </script>
</body>
</html>
